const unsigned cycles[256] = {
    1, 3, 2, 2, 1, 1, 2, 1, 5, 2, 2, 2, 1, 1, 2, 1,
    1, 3, 2, 2, 1, 1, 2, 1, 3, 2, 2, 2, 1, 1, 2, 1,
    2, 3, 2, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 1, 2, 1,
    2, 3, 2, 2, 3, 3, 3, 1, 2, 2, 2, 2, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1,
    2, 3, 3, 4, 3, 4, 2, 4, 2, 4, 3, 2, 3, 6, 2, 4,
    2, 3, 3, 0, 3, 4, 2, 4, 2, 4, 3, 0, 3, 0, 2, 4,
    3, 3, 2, 0, 0, 4, 2, 4, 4, 1, 4, 0, 0, 0, 2, 4,
    3, 3, 2, 1, 0, 4, 2, 4, 3, 2, 4, 1, 0, 0, 2, 4
};

const unsigned cycles0xCB[256] = {
    2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 2, 2, 2, 2, 4, 2,
    2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 2, 2, 2, 2, 4, 2,
    2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 2, 2, 2, 2, 4, 2,
    2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 2, 2, 2, 2, 4, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2,
    2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2
};

const unsigned regs[256] = {
 // 0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B  0x0C  0x0D  0x0E  0x0F
    0x00, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x00, 0x10, 0x1A, 0x02, 0x02, 0x02, 0x02, 0x02, 0x00, // 0x00
    0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, 0x00, 0x1C, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, // 0x10
    0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00, 0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, // 0x20
    0x00, 0x10, 0x08, 0x10, 0x08, 0x08, 0x08, 0x00, 0x00, 0x18, 0x08, 0x10, 0x00, 0x00, 0x00, 0x00, // 0x30
    0x02, 0x02, 0x06, 0x06, 0x0A, 0x0A, 0x0A, 0x02, 0x02, 0x02, 0x06, 0x06, 0x0A, 0x0A, 0x0A, 0x02, // 0x40
    0x06, 0x06, 0x04, 0x04, 0x0C, 0x0C, 0x0C, 0x04, 0x06, 0x06, 0x04, 0x04, 0x0C, 0x0C, 0x0C, 0x04, // 0x50
    0x0A, 0x0A, 0x0C, 0x0C, 0x08, 0x08, 0x08, 0x08, 0x0A, 0x0A, 0x0C, 0x0C, 0x08, 0x08, 0x08, 0x08, // 0x60
    0x0A, 0x0A, 0x0C, 0x0C, 0x08, 0x08, 0x00, 0x08, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x70
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x80
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x90
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xA0
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xB0
    0x00, 0x12, 0x00, 0x00, 0x10, 0x12, 0x00, 0x10, 0x10, 0x10, 0x00, 0x1E, 0x10, 0x10, 0x00, 0x10, // 0xC0
    0x10, 0x14, 0x00, 0x00, 0x10, 0x14, 0x00, 0x10, 0x10, 0x10, 0x00, 0x00, 0x10, 0x00, 0x00, 0x10, // 0xD0
    0x00, 0x18, 0x02, 0x00, 0x00, 0x18, 0x00, 0x10, 0x10, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, // 0xE0
    0x00, 0x10, 0x02, 0x00, 0x00, 0x10, 0x00, 0x10, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10  // 0xF0
};

const unsigned regs0xCB[256] = {
 // 0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B  0x0C  0x0D  0x0E  0x0F
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x00
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x10
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x20
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x30
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x40
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x50
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x60
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x70
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x80
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0x90
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xA0
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xB0
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xC0
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xD0
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, // 0xE0
    0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08, 0x08, 0x00  // 0xF0
};

const unsigned break_on[256] = {
 // 0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0
    1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 1
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 2
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 3
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 4
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 5
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 6
    0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 7
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 8
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 9
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // A
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // B
    0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, // C
    0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, // D
    1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, // E
    1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  // F
};

const unsigned compilability[256] = {
 // 0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 0
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 1
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 2
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 3
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 4
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 5
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 6
    1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 7
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 8
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 9
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // A
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // B
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // C
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // D
    0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // E
    0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1  // F
};

static unsigned op_ops[256] = {
 // 0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F
    0, 2, 0, 0, 0, 0, 1, 0, 2, 0, 0, 0, 0, 0, 1, 0, // 0
    0, 2, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, // 1
    1, 2, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, // 2
    1, 2, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, // 3
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 4
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 5
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 6
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 7
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 8
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 9
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // A
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // B
    0, 0, 2, 2, 2, 0, 1, 0, 0, 0, 2, 0, 2, 2, 1, 0, // C
    0, 0, 2, 0, 2, 0, 1, 0, 0, 0, 2, 0, 2, 0, 1, 0, // D
    1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 2, 0, 0, 0, 1, 0, // E
    1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 2, 0, 0, 0, 1, 0  // F
};
